{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Nmap Script Tutorial","text":"<p>These docs give a brief intro to writing nmap scripts.</p> <p>The nmap guide already has documenation on this, namely its chapter on the Nmap Scripting Engine. In fact, much of these docs are taken straight from there. However, the nmap guide is a bit old and lacks some helpful navigation features that could enhance its readability.</p> <p>The goal of these docs are to provide a faster quickstart guide to those looking to create lua scripts to extend nmap's functionality.</p>"},{"location":"#prerequisites","title":"Prerequisites","text":"<ul> <li>Familitary with nmap.</li> <li>Very basic knowledge of the lua programming language.<ul> <li>See here for an intro to lua.</li> </ul> </li> <li>These docs are written with the assumption that you are using a linux system; some info may not apply to other platforms.</li> </ul>"},{"location":"getting-started/","title":"Getting Started","text":""},{"location":"getting-started/#what-can-nmap-scripts-do","title":"What can nmap scripts do?","text":"<p>The Nmap Scripting Engine (NSE) allows you to write lua scripts that extend the functionality of nmap. It was designed to help enable users to do custome tasks dealing with:</p> <ul> <li>Network discovery</li> <li>More sophisticated version detection</li> <li>Vulnerability detection</li> <li>Backdoor detection</li> <li>Vulnerability exploitation</li> </ul>"},{"location":"getting-started/#hello-world","title":"Hello World","text":"<p>A simple \"hello world\" nmap script could look like this...</p> <pre><code>prerule = function()\n  return true\nend\n\naction = function(host, port)\n  return \"hello world\"\nend\n</code></pre> <p>...and then its output would look like this:</p> nmap --script=./helloworld.nse 127.0.0.1Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-18 20:35 EDTPre-scan script results:|_helloworld: hello worldNmap scan report for localhost (127.0.0.1)Host is up (0.000019s latency).Not shown: 999 closed tcp ports (conn-refused)PORT     STATE SERVICE8000/tcp open  http-altNmap done: 1 IP address (1 host up) scanned in 0.04 seconds <p></p>"},{"location":"getting-started/#script-format","title":"Script Format","text":"<p>At the top of your script, you may optionally define these fields:</p> <ul> <li><code>description</code>: A short description of what the script does. This is shown in the </li> <li><code>author</code>: Your name.</li> <li><code>license</code>: The license under which the script is released. (e.g. \"MIT\")</li> <li><code>categories</code>: A list of categories that the script belongs to. This is used for organizing scripts in the nmap script database. (e.g. {\"discovery\", \"vuln\"})</li> </ul>"},{"location":"getting-started/#the-action","title":"The Action","text":"<p>The action is a lua function named <code>action</code> defined by your script that gets triggered if any rule evaluates to true.</p> <p>It takes two arguments: <code>host</code> and <code>port</code>. The <code>host</code> argument is a table that contains information about the target hosts, and the <code>port</code> argument is a table that contains information about the target ports.</p> <p>Lua Tables</p> <p>If you're coming from python, you can sort of think of lua tables as dictionaries or objects, but lua tables are more flexible and can be used as arrays as well. See here for a quick intro to lua tables.</p>"},{"location":"getting-started/#rules-and-actions","title":"Rules and Actions","text":"<p>A rule is a Lua function that returns either true or false. </p> <p>Rules determine whether a script should be run against a target. </p> <p>Scripts can have one or more (up to four) rules. Each rule is evaluated at different phases of the nmap run.</p> <p><code>hostrule</code> and <code>portrule</code> take args that are lua tables which contain information on the target against which the script is executed.</p>"},{"location":"getting-started/#prerule","title":"prerule()","text":"<p>Called before any any hosts are scanned, during the pre-scanning phase.</p>"},{"location":"getting-started/#hostrulehost","title":"hostrule(host)","text":"<p>Called during Nmap's normal scanning process after Nmap has performed host discovery, port scanning, version detection, and OS detection against the target host.</p> <p>For each host that is up, nmap calls <code>hostrule</code>, passing it info about the host in the <code>host</code> table. The <code>hostrule</code> function can then check properties of the host to determine if it should trigger the <code>action</code>. For example, it might check to see if <code>host.ip</code> is a certain value, then return <code>true</code> to trigger the action. In lua, this would look like this:</p> <pre><code>hostrule = function(host)\n    return host.ip == \"192.168.1.1\"\nend\n\naction = function(host, port)\n    return \"hello world\"\nend\n</code></pre>"},{"location":"getting-started/#portrulehost-port","title":"portrule(host, port)","text":"<p>This function gets called for every port on every host that is up.</p> Example <p>Consider this script:</p> portrule.nse<pre><code>portrule = function(host, port)\n    return port.number == 8000\nend \naction = function(host, port)\n    return \"port 8000 is open\"\nend\n</code></pre> <p>Running it produces this output:</p> <p>nmap --script=./portrule.nse 127.0.0.1Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-19 08:59 EDTNmap scan report for localhost (127.0.0.1)Host is up (0.000022s latency).Not shown: 998 closed tcp ports (conn-refused)PORT     STATE SERVICE631/tcp  open  ipp8000/tcp open  http-alt|_portrule: Port 8000 is open on 127.0.0.1Nmap done: 1 IP address (1 host up) scanned in 0.04 seconds</p> <p>Notice that although two ports were open, nmap only ran the action for port 8000.</p>"},{"location":"getting-started/#postrule","title":"postrule()","text":""}]}